webpackJsonp([51],{"14/o":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Dd8w"),s=i.n(n),a=i("NYxO"),o={data:function(){return{momentsText:"",dialogImageUrl:"",dialogVisible:!1,uploadId:"",allImg:[],hideUpload:!1,saveImgList:[],parm:{self_uid:"",page:1,page_size:"10"}}},computed:s()({},Object(a.c)(["getUserId"])),created:function(){},methods:s()({},Object(a.b)(["addMoments","addPhoneAction","getFriendListAction"]),{upload:function(t,e){},beforeAvatarUpload:function(t){var e=this;if(!/^image\/(jpeg|png|jpg|gif)$/.test(t.type))return this.$message.error("上传图片只能是 JPG PNG GIF 格式!"),!1;var i=new FormData;i.append("file",t),this.addPhoneAction(i).then(function(i){if(!i.path)return!1;e.saveImgList.push({uid:t.uid,path:i.path}),e.hideUpload=e.saveImgList.length>=9})},handleRemove:function(t){var e=this.saveImgList.findIndex(function(t){return t.uid});this.saveImgList.splice(e,1),this.hideUpload=this.saveImgList.length>=9},cancelSend:function(){this.$emit("sendData",!1)},commitMoment:function(){var t=this;if(!this.momentsText&&0==this.saveImgList.length)return this.$notify({title:"警告",message:"请输入要发表的内容",type:"warning"}),!1;var e="";this.saveImgList.length>0&&(e=this.saveImgList.map(function(t){return t.path})),this.momentsText=this.momentsText.replace(/\n|\r\n/g,"<br>"),this.addMoments({self_uid:this.getUserId,content:this.momentsText,picture:e}).then(function(e){10002===e.code&&t.$emit("sendData",!1)})}})},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"send-wrapper"},[i("div",{staticClass:"newfriend"},[i("span",{staticClass:"send-cancel point",on:{click:t.cancelSend}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"nickname"},[t._v("发朋友圈")]),t._v(" "),i("span",{staticClass:"send-issue point",on:{click:function(e){return t.commitMoment()}}},[t._v("发表")])]),t._v(" "),i("div",{staticClass:"input-content"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.momentsText,expression:"momentsText"}],attrs:{cols:"15",rows:"5",placeholder:"这一刻的想法..."},domProps:{value:t.momentsText},on:{input:function(e){e.target.composing||(t.momentsText=e.target.value)}}}),t._v(" "),i("div",{staticClass:"content-upload"},[i("el-upload",{ref:"refContent",class:{hide:t.hideUpload},attrs:{action:"","list-type":"picture-card","on-remove":t.handleRemove,"http-request":t.upload,"before-upload":t.beforeAvatarUpload}},[i("i",{staticClass:"el-icon-plus"})]),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible,size:"tiny"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)])])},staticRenderFns:[]};var l=i("VU/8")(o,d,!1,function(t){i("mkTm")},null,null);e.default=l.exports},mkTm:function(t,e){}});