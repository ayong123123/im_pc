webpackJsonp([24],{"/qwH":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("Xxa5"),a=s.n(i),r=s("exGp"),n=s.n(r),o=s("Dd8w"),c=s.n(o),l=s("NYxO"),d=(s("zL8q"),s("F+jZ")),h=s("y1Vc"),u=s.n(h),g={data:function(){return{moren:u.a,searchText:"",getTimes:d.d,historySwitch:!1,historyMsgLoading:!0,singleInfo:{img:"",name:"",remarks_name:""}}},computed:c()({},Object(l.e)(["chatListStore","friendsListStore","msgListStore","chatuserInfoStore"]),Object(l.c)(["getUserId","selectedChat"])),watch:{historyMsgLoading:function(t,e){}},created:function(){this.singleInfo=this.selectedChat.user},mounted:function(){},beforeDestroy:function(){this.setHistoryMessage(""),this.setHistoryMessageData(""),this.historySwitch=!1,this.historyMsgLoading=!0},methods:c()({},Object(l.b)(["addMyFriendAction","getForbiddenUserList","forbiddenUser","getHistoryMessageAction","getSingleHistoryMessageAction"]),Object(l.d)(["setModalState","setHistoryMessage","setHistoryMessageData","setAnchorInfo","setClickContent"]),{scrollTo:function(){var t=this;return n()(a.a.mark(function e(){var s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=[],e.next=3,t.$nextTick(function(){for(var e=document.querySelector("#chat-list").querySelector("ul").querySelectorAll("li.message-item"),i=0;i<e.length;i++)s.push(e[i].querySelector(".texts .main .text"));t.$refs.list.scrollTop=e.offsetTop});case 3:case"end":return e.stop()}},e,t)}))()},onKeyup:function(t){if(!t.shiftKey&&13===t.keyCode)return this.SearchRecord(),t.preventDefault(),!1},goHistoryMsg:function(t){var e=this;this.setClickContent(t),this.setHistoryMessageData(""),setTimeout(function(){e.historySwitch=!0},0),1*this.msgListStore.activeTyep==1?this.getSingleHistoryMessageAction({friendId:this.selectedChat.id,keyword:"",time:t.create_time,judge:3}).then(function(t){e.historyMsgLoading=!1}):this.getHistoryMessageAction({groupId:this.msgListStore.activeWindowId,keyword:"",time:t.create_time,judge:3}).then(function(t){e.historyMsgLoading=!1})},SearchRecord:function(){1*this.msgListStore.activeTyep==2?this.getHistoryMessageAction({groupId:this.msgListStore.activeWindowId,keyword:this.searchText}):this.getSingleHistoryMessageAction({friendId:this.selectedChat.id,keyword:this.searchText})},keywordscolorful:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.searchText,s=new RegExp("("+e+")","g");return t.replace(s,"<font style='background:#adf3ad;'>$1</font>")}})},v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("transition",[i("div",{staticClass:"look-new-friend-modal"},[i("div",{staticClass:"look-new-friend-head"},[t.historySwitch?i("a",{staticClass:"goback",attrs:{href:"javascript:;"},on:{click:function(e){t.historySwitch=!1,t.historyMsgLoading=!0}}},[t._v("返回上一级")]):t._e(),t._v(" "),i("i",{staticClass:"el-icon-close",on:{click:function(e){return t.setModalState("searchRecord")}}}),t._v("\n                搜索本地聊天记录\n            ")]),t._v(" "),t.historySwitch?t._e():i("div",{staticStyle:{height:"100%"}},[i("div",{staticClass:"search-wrapper"},[i("el-input",{attrs:{type:"text",placeholder:"搜索内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onKeyup(e)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.SearchRecord()}}},[t._v("搜索")])],1),t._v(" "),t.friendsListStore.historyMessage.data?i("div",{staticClass:"search-details"},[i("p",{staticClass:"title"},[t._v("聊天记录查询")]),t._v(" "),t._l(t.friendsListStore.historyMessage.data,function(e,a){return i("div",{key:a,staticClass:"look-new-friend-detail flex",on:{click:function(s){return t.goHistoryMsg(e)}}},[i("div",{staticClass:"flex-l"},[1*t.msgListStore.activeTyep==2?i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.head_portrait||t.moren,expression:"item.head_portrait || moren"}],staticClass:"avatar",attrs:{alt:""}}):i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.selectedChat.user.img||t.moren,expression:"selectedChat.user.img || moren"}],staticClass:"avatar",attrs:{alt:""}}),t._v(" "),i("div",{staticClass:"look-new-friend-user"},[i("div",{staticClass:"look-new-friend-diqu top"},[1*t.msgListStore.activeTyep==2?i("p",{staticClass:"nikename"},[t._v("\n                                        "+t._s(e.username)+"\n                                    ")]):i("p",{staticClass:"nikename"},[t._v(t._s(t.selectedChat.user.remarks_name||t.selectedChat.user.name))]),t._v(" "),i("p",[t._v(t._s(t.getTimes(e.create_time)))])]),t._v(" "),i("div",{staticClass:"bottom",domProps:{innerHTML:t._s(t.keywordscolorful(e.content))}})])]),t._v(" "),i("img",{staticClass:"go",attrs:{src:s("IuC6"),alt:"",width:""}})])})],2):i("div",{staticStyle:{"text-align":"center",color:"#999","line-height":"30px"}},[t._v("\n                    请输入要搜索的内容\n                ")])]),t._v(" "),t.historySwitch?i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.historyMsgLoading,expression:"historyMsgLoading"}],staticStyle:{position:"absolute",top:"200px",width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}}):t._e(),t._v(" "),t.friendsListStore.historyMessageData.data&&t.historySwitch?i("div",{ref:"list",staticClass:"history-wrapper",attrs:{id:"chat-list"}},[i("ul",t._l(t.friendsListStore.historyMessageData.data,function(e,s){return i("li",{staticClass:"history-item",class:{self:e.userMsg||e.send_uid==t.getUserId,clickRef:t.friendsListStore.clickContent.content==e.content&&t.friendsListStore.clickContent.unique_value==e.unique_value},attrs:{"data-info":e.unique_value}},[e.head_portrait?i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.head_portrait,expression:"item.head_portrait"}],staticClass:"avatar",attrs:{width:"36",height:"36"}}):e.send_uid==t.getUserId?i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.chatuserInfoStore.dataGetInfo.head_portrait,expression:"chatuserInfoStore.dataGetInfo.head_portrait"}],staticClass:"avatar",attrs:{width:"36",height:"36"}}):i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.selectedChat.user.img,expression:"selectedChat.user.img"}],staticClass:"avatar",attrs:{width:"36",height:"36"}}),t._v(" "),i("div",{staticClass:"content_wrapper"},[i("div",{staticClass:"title_time"},[i("span",{staticClass:"username"},[t._v(t._s(e.username))]),t._v(" "),i("span",[t._v(t._s(t.getTimes(e.create_time)))])]),t._v(" "),i("div",{staticClass:"content",style:t.friendsListStore.clickContent.content==e.content&&t.friendsListStore.clickContent.unique_value==e.unique_value?{color:"red"}:""},[t._v(t._s(e.content))])])])}),0)]):t._e(),t._v(" "),i("div",{staticClass:"text11"},[t._v("121212")])])])],1)},staticRenderFns:[]};var y=s("VU/8")(g,v,!1,function(t){s("cdOn")},"data-v-5c1e34db",null);e.default=y.exports},IuC6:function(t,e,s){t.exports=s.p+"pcImstatic/img/right_icon.3a439ca.png"},cdOn:function(t,e){}});