webpackJsonp([10],{"5dMP":function(e,t){},CHTb:function(e,t,s){e.exports=s.p+"pcImstatic/img/gg_close.a8a2a8c.png"},rvFy:function(e,t,s){e.exports=s.p+"pcImstatic/img/goDownNow.6c243bc.png"},vCih:function(e,t,s){e.exports=s.p+"pcImstatic/img/gg_up.9520867.png"},xMYe:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("mvHQ"),i=s.n(n),o=s("Gu7T"),r=s.n(o),a=s("Dd8w"),c=s.n(a),d=s("NYxO"),g=s("SQjO"),u={data:function(){return{config:g.a,systemPage:1,transpondData:{visible:!1},configData:{visible:!1,data:""},chongFaDetail:"",gogaoHidden:!0,forbiddenInfo:{selectDomTime:"",forbiddenStatus:""}}},created:function(){this.chatListStore.chatlist.length>0&&(1*this.msgListStore.activeTyep==1&&this.getLastMessageAction({send_uid:this.getUserId,accept_uid:this.msgListStore.activeWindowId}),1*this.msgListStore.activeTyep==2&&(this.getGlastMessageAction({send_id:this.getUserId,group_id:this.msgListStore.activeWindowId}),this.getGroupNoticeAction({self_uid:this.getUserId,group_id:this.msgListStore.activeWindowId})),1*this.msgListStore.activeTyep==3&&this.getMergeNoticeAction({Page:this.systemPage,pageNum:10}))},computed:c()({},Object(d.c)(["selectedChat","searchedChatlist","getUserId","getChatList","getFindMeMsg","getFindMeState","isBoss","isManagement"]),Object(d.e)(["chatListStore","friendsListStore","msgListStore","wechatIMstore","indexStore"])),beforeDestroy:function(){try{this.$refs.list.removeEventListener("scroll",this.handleScroll)}catch(e){}},mounted:function(){var e=this;try{setTimeout(function(){return e.$refs.list.scrollTop=e.$refs.list.scrollHeight},100),this.$refs.list.addEventListener("scroll",this.handleScroll),this.handleScroll()}catch(e){}},watch:{"selectedChat.id":function(e,t){var s=this;setTimeout(function(){return s.$refs.list.scrollTop=s.$refs.list.scrollHeight},300)},getChatList:function(e,t){var s=this;if(""==this.friendsListStore.anchorInfo&&e.length>0){var n=[].concat(r()(e));"succeed"==n[n.length-1].status&&!n[n.length-1].userMsg||"succeed"==n[n.length-1].status&&n[n.length-1].send_uid==this.getUserId?this.setIsGoDown(!0):(this.setIsGoDown(!1),setTimeout(function(){return s.$refs.list.scrollTop=s.$refs.list.scrollHeight},0))}}},methods:c()({},Object(d.d)(["setModalState","setChatRightBoxState","setChatRightFriendBoxState","windowMove","setIsGoDown","setChatRoomFindUser","setCloseFindMeModal","setRemarkName","clearMessageBack","setZhuanFaMessage","setHandleUserVible"]),Object(d.b)(["getLastMessageAction","getGlastMessageAction","getJudegMessageAction","getGjudgeMessageAction","getSofflineMessageAction","getGroupOfflineMessageAction","getGroupChatInfoAction","getFriendInfoAction","getMergeNoticeAction","addMergeNoticeAction","sendMessageIM","getGroupNoticeAction","isReadNoticeAction","delGroupAction","getForbiddenStatus","forbiddenUser"]),{goLink:function(e){var t=this;try{!function(){var s=document.querySelectorAll(".message-item"),n=function(n){if("texts"==s[n].firstElementChild.getAttribute("class")){var i=s[n].firstElementChild.childNodes[2].childNodes[6].childNodes[0].innerText,o=new Date(s[n].firstElementChild.firstChild.firstChild.innerText)/1e3;i==e.content&&o==e.create_time&&setTimeout(function(){return t.$refs.list.scrollTo(0,s[n].offsetTop)},200)}};for(var i in s)n(i)}()}catch(e){}},openHandleUserVible:function(e){var t=this;if(2==this.selectedChat.chatType&&e.asFrom!=this.getUserId&&(this.isBoss||this.isManagement)){this.forbiddenInfo.selectDomTime=e.create_time,this.forbiddenInfo.unique_value=e.unique_value;var s=e.asFrom||e.send_uid;this.getForbiddenStatus({uid:s,group_id:this.msgListStore.activeWindowId}).then(function(e){t.forbiddenInfo.forbiddenStatus=e.data.status,t.setHandleUserVible(!0)})}},isStopTalking:function(e){if(this.isBoss||this.isManagement){var t=e.asFrom||e.send_uid,s=null;s=1==this.forbiddenInfo.forbiddenStatus?2:1,this.forbiddenUser({self_uid:this.getUserId,group_id:this.msgListStore.activeWindowId,forbidden_uid:t,status:s})}},removeGroupUser:function(e){var t=this;(this.isBoss||this.isManagement)&&this.$confirm("确定删除此群员吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s=e.asFrom||e.send_uid;t.delGroupAction({self_uid:t.getUserId,group_id:t.msgListStore.activeWindowId,del_uid:s})}).catch(function(){})},closeGonggao:function(){this.setCloseFindMeModal(),this.isReadNoticeAction({self_uid:this.getUserId,group_id:this.msgListStore.activeWindowId})},reSendMessage:function(e){this.chongFaDetail=e,this.chongFaMessage()},chongFaMessage:function(){var e=this;this.clearMessageBack({id:this.msgListStore.activeWindowId,type:this.msgListStore.activeTyep,unique_value:this.chongFaDetail.unique_value});var t={to:this.chongFaDetail.asTo,message:this.chongFaDetail.content,type:this.chongFaDetail.type,reserved:i()({level:this.indexStore.userHomeData.data.userlevelid.level,levelName:this.indexStore.userHomeData.data.userlevelid.levelName})};if(2==this.chongFaDetail.asGroup){var s={};s.groupName=this.friendsListStore.groupChatInfoList.data.group_name,s.count=this.friendsListStore.groupChatInfoList.data.count,t.groupinfo=s}setTimeout(function(){e.sendMessageIM(t)},1e3)},openConfig:function(e){this.configData.data=e,this.configData.visible=!0},closeConfig:function(){this.configData.visible=!1},closeTranspond:function(){this.transpondData.visible=!1},getZhuanFa:function(e){this.setZhuanFaMessage(e),this.transpondData.visible=!0},messageBack:function(e){var t={to:this.msgListStore.activeWindowId,message:e.unique_value,type:1==this.msgListStore.activeTyep?g.a.MSG_PRIVATE_RECALL:g.a.MSG_PRIVATE_GROUPRECALL,reserved:i()({level:this.indexStore.userHomeData.data.userlevelid.levelName})};if(2==this.msgListStore.activeTyep){var s={};s.groupName=this.friendsListStore.groupChatInfoList.data.group_name,s.count=this.friendsListStore.groupChatInfoList.data.count,s.findId=e.send_uid||e.groupmessage.sendid,(this.isBoss||this.isManagement)&&(s.findId=this.getUserId),s.findId=s.findId+"",t.groupinfo=s}this.sendMessageIM(t),this.$message.success("撤回消息成功！"),this.clearMessageBack({id:this.msgListStore.activeWindowId,type:this.msgListStore.activeTyep,unique_value:e.unique_value})},otherAudioPaused:function(e){e.map(function(e){"isPlay"in e&&e.isPlay&&(e.isPlay=!1)});var t=document.getElementsByClassName("audio_tag");for(var s in t)void 0!=t[s].paused&&(t[s].setAttribute("data-flag","true"),t[s].paused||(t[s].pause(),t[s].setAttribute("data-flag","false")))},getFindUser:function(e){if(2==this.selectedChat.chatType&&(1==this.friendsListStore.groupChatInfoList.data.is_forbidden||this.isBoss||this.isManagement)&&(!e.userMsg&&2==e.asGroup||!e.asGroup&&e.send_uid!=this.getUserId&&2==this.selectedChat.chatType)){var t=e.nickname,s=e.asFrom||e.send_uid;this.setChatRoomFindUser({nickname:t,uid:s,status:!0})}},goBottom:function(){var e=this;setTimeout(function(){return e.$refs.list.scrollTop=e.$refs.list.scrollHeight},0)},handleScroll:function(){var e=this.$refs.list.scrollTop,t=this.$refs.list.offsetHeight,s=this.$refs.list.scrollHeight;this.isShowDown(e,t,s)},isShowDown:function(e,t,s){s-(t-100+e)<100?this.setIsGoDown(!1):this.setIsGoDown(!0)},getHistory:function(e){var t=this;if(1==this.selectedChat.chatType)if(0==this.getChatList.length)this.getLastMessageAction({send_uid:this.getUserId,accept_uid:this.selectedChat.id});else{var s=this.msgListStore.friendMsgMap[this.selectedChat.id].msgList[0].unique_value,n=this.$refs.list.scrollTop;this.getJudegMessageAction({send_uid:this.getUserId,accept_uid:this.selectedChat.id,uniqueId:s,isUpDown:2}).then(function(){setTimeout(function(){return t.$refs.list.scrollTo(0,n)},200)})}if(2==this.selectedChat.chatType)if(0==this.getChatList.length)this.getGlastMessageAction({send_id:this.getUserId,group_id:this.selectedChat.id});else{var i=this.msgListStore.roomMsgMap[this.selectedChat.id].msgList[0].unique_value;n=this.$refs.list.scrollTop;this.getGjudgeMessageAction({send_id:this.getUserId,group_id:this.selectedChat.id,uniqueId:i,isUpDown:2}).then(function(){setTimeout(function(){return t.$refs.list.scrollTo(0,n)},200)})}3==this.selectedChat.chatType&&(this.wechatIMstore.mergeNoticeList.data&&0!=this.wechatIMstore.mergeNoticeList.data.length?(this.systemPage++,this.addMergeNoticeAction({Page:this.systemPage,pageNum:10})):this.getMergeNoticeAction({Page:1,pageNum:10}))},getFriendInfo:function(){var e=this;this.getFriendInfoAction({self_uid:this.getUserId,friend_uid:this.msgListStore.activeWindowId}).then(function(t){e.setRemarkName({friend_uid:t.id,remarks_name:t.remarks_name,nickname:t.nickname}),e.setChatRightFriendBoxState(!0)})}}),filters:{time:function(e){return"string"==typeof e&&(e=new Date(e)),e.getMinutes()<10?e.getHours()+":0"+e.getMinutes():e.getHours()+":"+e.getMinutes()}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.chatListStore.chatlist.length>0?n("div",{staticClass:"user-chat-message"},[n("header",{staticClass:"header flex-between",on:{mousedown:function(t){return e.windowMove(t)}}},[void 0!==e.selectedChat.chatType?n("div",{staticClass:"friendname"},[e._v("\n        "+e._s(2==e.selectedChat.chatType?e.friendsListStore.groupChatInfoList.data.group_name:e.selectedChat.user.remarks_name?e.selectedChat.user.remarks_name:e.selectedChat.user.name)+"\n        "),2==e.selectedChat.chatType?n("span",[e._v("("+e._s(e.friendsListStore.groupChatInfoList.data.count)+")")]):e._e()]):e._e(),e._v(" "),2==e.selectedChat.chatType?n("span",{staticClass:"chat-more-icon",on:{click:function(t){return e.setChatRightBoxState(!0)}}}):e._e(),e._v(" "),1==e.selectedChat.chatType?n("span",{staticClass:"chat-more-icon",on:{click:e.getFriendInfo}}):e._e()]),e._v(" "),e.getFindMeMsg.length>0&&e.getFindMeState&&2==e.selectedChat.chatType?n("div",{staticClass:"have-people-findme"},[e._l(e.getFindMeMsg,function(t,s){return n("div",{on:{click:function(t){e.gogaoHidden=!e.gogaoHidden}}},[t.describe||t.type==e.config.MSG_GROUP_NOTICE?n("span",[e._v("群公告")]):t.type==e.config.MSG_GROUP_AT||t.type==e.config.MSG_GROUP_AT_ALL?n("span",[e._v("有人@你")]):t.type==e.config.MSG_GROUP_REMOVEPERSON?n("span",[e._v("移出群聊")]):e._e(),e._v(" "),n("div",{class:{"long-text":e.gogaoHidden}},[e._v(e._s(t.describe||t.groupmessage.content))])])}),e._v(" "),e.gogaoHidden?n("img",{attrs:{src:s("CHTb"),alt:""},on:{click:function(t){return e.closeGonggao()}}}):n("img",{attrs:{src:s("vCih"),alt:""},on:{click:function(t){e.gogaoHidden=!0}}})],2):e._e(),e._v(" "),n("div",{ref:"list",staticClass:"message-wrapper",class:{on:3==e.msgListStore.activeTyep},attrs:{id:"chat-list"}},[e.selectedChat&&e.getChatList&&3!=e.msgListStore.activeTyep?n("ul",[n("li",{staticClass:"message-item more-history"},[n("div",{on:{click:e.getHistory}},[e._v("\n            查看更多消息\n          ")])]),e._v(" "),e._l(e.getChatList,function(t){return n("li",{staticClass:"message-item"},[t.type==e.config.MSG_PRIVATE_TXT||t.type==e.config.MSG_GROUP_TXT||t.type==e.config.MSG_GROUP_NOTICE||t.type==e.config.MSG_GROUP_AT||t.type==e.config.MSG_GROUP_AT_ALL?n("wx-chat-text",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{setFindUser:e.getFindUser,messageBack:function(s){return e.messageBack(t)},reSendMessage:function(s){return e.reSendMessage(t)},openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},getZhuanFa:function(s){return e.getZhuanFa(t)},openConfig:e.openConfig}}):e._e(),e._v(" "),t.type==e.config.MSG_PRIVATE_IMG||t.type==e.config.MSG_GROUP_IMG?n("wx-chat-images",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,messageBack:function(s){return e.messageBack(t)},getZhuanFa:function(s){return e.getZhuanFa(t)},openConfig:e.openConfig,reSendMessage:function(s){return e.reSendMessage(t)}}}):e._e(),e._v(" "),t.type==e.config.MSG_PRIVATE_RED||t.type==e.config.MSG_GROUP_RED?n("wx-chat-redpack",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,reSendMessage:function(s){return e.reSendMessage(t)}}}):e._e(),e._v(" "),t.type==e.config.MSG_MONEY_TRANSFER||t.type==e.config.MSG_MONEY_TRANSFER?n("wx-chat-transfer",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,reSendMessage:function(s){return e.reSendMessage(t)}}}):e._e(),e._v(" "),t.type==e.config.MSG_RED_COW?n("wx-chat-bullpack",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,reSendMessage:function(s){return e.reSendMessage(t)}}}):e._e(),e._v(" "),t.type==e.config.MSG_RED_LANDMINE?n("wx-chat-sweeppack",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,reSendMessage:function(s){return e.reSendMessage(t)}}}):e._e(),e._v(" "),t.type==e.config.MSG_RED_DRAGON?n("wx-chat-dragonpack",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,reSendMessage:function(s){return e.reSendMessage(t)}}}):e._e(),e._v(" "),t.type==e.config.MSG_GROUP_CARD||t.type==e.config.MSG_PRIVATE_CARD?n("wx-user-card",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,messageBack:function(s){return e.messageBack(t)},reSendMessage:function(s){return e.reSendMessage(t)},getZhuanFa:function(s){return e.getZhuanFa(t)},openConfig:e.openConfig}}):e._e(),e._v(" "),t.type==e.config.MSG_PRIVATE_ROB||t.type==e.config.MSG_GROUP_ROB?n("wx-redpack-message",{attrs:{msg:t}}):e._e(),e._v(" "),t.type==e.config.MSG_GROUP_INGROUP||t.type==e.config.MSG_PRIVATE_AGREEADDFRIEND?n("wx-newUserInto",{attrs:{msg:t}}):e._e(),e._v(" "),t.type==e.config.MSG_GROUP_AUDIO||t.type==e.config.MSG_PRIVATE_AUDIO?n("wx-chat-audio",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,messageBack:function(s){return e.messageBack(t)},audioPaused:function(t){return e.otherAudioPaused(e.getChatList)}}}):e._e(),e._v(" "),t.type==e.config.MSG_GROUP_VIDEO||t.type==e.config.MSG_PRIVATE_VIDEO?n("wx-chat-video",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,reSendMessage:function(s){return e.reSendMessage(t)},messageBack:function(s){return e.messageBack(t)},getZhuanFa:function(s){return e.getZhuanFa(t)},openConfig:e.openConfig}}):e._e(),e._v(" "),t.type==e.config.MSG_GROUP_SIGN||t.type==e.config.MSG_PRIVATE_SIGN?n("wx-chat-sign",{attrs:{msg:t}}):e._e(),e._v(" "),t.type==e.config.MSG_GROUP_DASHANG||t.type==e.config.MSG_PRIVATE_DASHANG?n("wx-da-shang",{attrs:{msg:t}}):e._e(),e._v(" "),t.type==e.config.MSG_GROUP_SHARE||t.type==e.config.MSG_PRIVATE_SHARE?n("wx-share-record",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,reSendMessage:function(s){return e.reSendMessage(t)},messageBack:function(s){return e.messageBack(t)}}}):e._e(),e._v(" "),t.type==e.config.MSG_GROUP_SHARENOTE||t.type==e.config.MSG_PRIVATE_SHARENOTE?n("wx-share-order",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},setFindUser:e.getFindUser,reSendMessage:function(s){return e.reSendMessage(t)},messageBack:function(s){return e.messageBack(t)}}}):e._e(),e._v(" "),t.type==e.config.MSG_GROUP_PLAN?n("wx-sharePlan",{attrs:{msg:t,forbiddenInfo:e.forbiddenInfo},on:{openHandleUserVible:function(s){return e.openHandleUserVible(t)},isStopTalking:function(s){return e.isStopTalking(t)},removeGroupUser:function(s){return e.removeGroupUser(t)},reSendMessage:function(s){return e.reSendMessage(t)},messageBack:function(s){return e.messageBack(t)}}}):e._e(),e._v(" "),n("wx-config",{attrs:{msg:t,configData:e.configData},on:{messageBack:e.messageBack,getZhuanFa:e.getZhuanFa,closeConfig:e.closeConfig}})],1)})],2):n("ul",[n("li",{staticClass:"message-item more-history"},[n("div",{on:{click:e.getHistory}},[e._v("\n            查看更多\n          ")])]),e._v(" "),e._l(e.wechatIMstore.mergeNoticeList.data,function(e){return n("li",[n("system-gongGao",{attrs:{msg:e}})],1)})],2)])]):n("div",{staticClass:"not-message"},[e._v("\n      暂无聊天记录 快找好友聊聊天吧\n  ")]),e._v(" "),e.wechatIMstore.isGoDown&&e.chatListStore.chatlist&&e.chatListStore.chatlist.length>0?n("div",{staticClass:"newMessage",on:{click:e.goBottom}},[n("img",{attrs:{src:s("rvFy"),alt:""}})]):e._e(),e._v(" "),e.transpondData.visible?n("wx-transpond",{attrs:{transpondData:e.transpondData},on:{closeTranspond:e.closeTranspond}}):e._e()],1)},staticRenderFns:[]};var l=s("VU/8")(u,f,!1,function(e){s("5dMP")},"data-v-0a8271f4",null);t.default=l.exports}});